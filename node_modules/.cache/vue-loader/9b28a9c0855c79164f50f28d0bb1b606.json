{"remainingRequest":"/Users/yuxue/Desktop/web/data_collect_web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuxue/Desktop/web/data_collect_web/src/components/DataStore.vue?vue&type=style&index=0&id=160d5e69&scoped=true&lang=css&","dependencies":[{"path":"/Users/yuxue/Desktop/web/data_collect_web/src/components/DataStore.vue","mtime":1622961711755},{"path":"/Users/yuxue/Desktop/web/data_collect_web/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuxue/Desktop/web/data_collect_web/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yuxue/Desktop/web/data_collect_web/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yuxue/Desktop/web/data_collect_web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuxue/Desktop/web/data_collect_web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZWwtYnJlYWRjcnVtYnsKICBtYXJnaW4tYm90dG9tOjE1cHg7CiAgZm9udC1zaXplOiAxMnB4Owp9Ci5lbC1jYXJkewogIGJveC1zaGFkb3c6IDAgMXB4IDFweCByZ2JhKDAsMCwwLDAuMjUpIWltcG9ydGFudDsKfQo="},{"version":3,"sources":["DataStore.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkJA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DataStore.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n     <el-breadcrumb separator-class=\"el-icon-arrow-right\">\n      <el-breadcrumb-item :to=\"{ path: '/welcome' }\">首页</el-breadcrumb-item>\n      <el-breadcrumb-item>采集设备管理</el-breadcrumb-item>\n      <el-breadcrumb-item>网站爬虫</el-breadcrumb-item>\n      <el-breadcrumb-item>数据入库与告警</el-breadcrumb-item>\n      <el-breadcrumb-item>数据入库</el-breadcrumb-item>\n    </el-breadcrumb>\n    <el-card>\n      <el-table :data = 'websiteslist' stripe border style=\"width: 100%\">\n        <el-table-column type=\"index\"></el-table-column>\n        <el-table-column prop=\"websiteName\" label=\"网站名称\"> </el-table-column>\n        <el-table-column prop=\"url\" label=\"网站url\"> </el-table-column>\n        <el-table-column prop=\"state\" label=\"网站状态\"></el-table-column>\n        <el-table-column prop=\"scrapySelect\" label=\"爬虫实例\"></el-table-column>\n        <el-table-column prop=\"scrapyState\" label=\"爬虫状态\"></el-table-column>\n        <el-table-column label=\"数据表\" prop = \"tableName\">\n          <template slot-scope=\"scope\">\n            <el-select v-model = \"scope.row.tableName\" placeholder=\"请选择数据表\">\n              <el-option v-for = \"(item,index) in dbTableList\" :label= \"item\" :value = \"item\" :key = \"index\"></el-option>\n            </el-select>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\">\n          <template slot-scope=\"scope\">\n            <el-button type=\"primary\" @click=\"dataStore(scope.row)\">数据入库</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      <el-dialog title=\"数据入库\" :visible.sync=\"dataStoreVisible\" width=\"50%\" @close=\"resetForm()\">\n        <el-row><el-col :span=\"24\" >爬虫保存数据案例: {{topic}}</el-col></el-row>\n        <el-form :model=\"dropInfo\" :rules=\"addruleForm\" ref=\"addFormRef\" label-width=\"100px\" margin-top=\"3px\" :inline='true'>\n          <el-form-item prop=\"topic\">\n            <el-select v-model=\"dropInfo.topic\" placeholder=\"请选择topic\">\n              <el-option v-for = \"(item,index) in topics\" :label= \"item\" :value = \"item\" :key = \"index\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item prop=\"tableName\">\n            <el-select v-model=\"dropInfo.tableName\" placeholder=\"请选择数据列表\">\n              <el-option v-for = \"(item,index) in tableNames\" :label= \"item\" :value = \"item\" :key = \"index\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\">+</el-button>\n          </el-form-item>\n        </el-form>\n        <span slot=\"footer\">\n          <el-button @click=\"dataStoreVisible = false\">取 消</el-button>\n          <el-button type=\"primary\">入库</el-button>\n        </span>\n      </el-dialog>\n    </el-card>\n  </div>\n</template>\n\n<script>\nexport default {\n  data () {\n    return {\n      websiteslist: [{\n        websiteName: '',\n        url: '',\n        state: '',\n        scrapySelect: '',\n        scrapyState: ''\n      }],\n      // 选择的数据表的名字\n      dbTableList: [\n        '1', '2', '3'\n      ],\n      // 点击数据入库按钮弹出的对话框\n      dataStoreVisible: false,\n      // 爬虫保存数据案例\n      topic: '保存案例',\n      dropInfo: {\n        topic: ['1', '2', '3'],\n        tableName: ['1', '2', '3']\n      },\n      topics: ['1', '2', '3'],\n      tableNames: ['1', '2', '3']\n\n    }\n  },\n  created () {\n    this.getWebsitelist()\n    this.getDBTableList()\n  },\n  methods: {\n    async getWebsitelist () {\n      // 获取网站列表\n      const { data: res } = await this.$http.get('listWebsites')\n      if (res.code !== 200) {\n        return this.$message.error('获取网站列表失败')\n      }\n      this.websiteslist = res.entity\n    },\n    async getDBTableList () {\n      // 获取数据表名字\n      const { data: res } = await this.$http.get('listDBTableName')\n      if (res.code !== 200) {\n        return this.$message.error('获取数据列表失败')\n      }\n      this.dbTableList = res.entity\n    },\n    async dataStore (website) {\n      this.dataStoreVisible = true\n      this.getTopics()\n      this.getTableNames()\n      const params = new URLSearchParams()\n      params.append('scrapyName', website.scrapySelect)\n      const { data: res } = await this.$http.post('selectTopicByScrapyName', params)\n      if (res.code !== 200) {\n        return this.$message.error('获取爬虫topic失败')\n      }\n      const info = new URLSearchParams()\n      info.append('topic', res.entity)\n      const { data: res2 } = await this.$http.post('selectTopicByScrapyName', info)\n      if (res2.code !== 200) {\n        return this.$message.error('根据爬虫获取爬虫实例失败')\n      }\n      this.topic = res2.entity\n    },\n    async getTopics (topic) {\n      const params = new URLSearchParams()\n      params.append('topic', topic)\n      const { data: res } = await this.$http.post('listTopicColumns', params)\n      if (res.code !== 200) {\n        return this.$message.error('获取爬虫topic失败')\n      }\n      this.topics = this.entity\n    },\n    async getTableNames (tableName) {\n      const params = new URLSearchParams()\n      params.append('tableName', tableName)\n      const { data: res } = await this.$http.post('listTableColumn', params)\n      if (res.code !== 200) {\n        return this.$message.error('获取数据列表失败')\n      }\n      this.tableNames = this.entity\n    }\n  }\n}\n</script>\n\n<style scoped>\n.el-breadcrumb{\n  margin-bottom:15px;\n  font-size: 12px;\n}\n.el-card{\n  box-shadow: 0 1px 1px rgba(0,0,0,0.25)!important;\n}\n</style>\n"]}]}